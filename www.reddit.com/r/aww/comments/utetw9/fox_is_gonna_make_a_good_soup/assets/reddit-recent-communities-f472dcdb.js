import{_ as e,e as t,n,f as s,I as i,L as d,an as a,t as r,r as c,T as o,$ as l,ao as u,ap as m,s as h}from"./shell-f8d273fb.js";import{W as p}from"./with-pubsub-d126236e.js";const b=s(p(h));let f=class extends b{constructor(){super(...arguments),this.expanded=!1,this.onRecentSubredditReceived=e=>{const t=this.getRecentSubreddits(),n=new Map,s=[e,...t];for(;s.length&&n.size<5;){const e=s.shift();n.has(e.uuid)||n.set(e.uuid,e)}const a=Array.from(n.values());a.length===t.length&&a.every(((e,n)=>e.uuid===t[n].uuid))||(i.setItem(d.RecentSubreddits,JSON.stringify(a)),this.requestUpdate())},this.onSubredditClick=()=>{this.trackEvent(a())}}static get styles(){return[r,c`summary::-webkit-details-marker{display:none}details[open] icon-caret-down{transform:rotate(180deg)}`]}connectedCallback(){super.connectedCallback(),window.setTimeout((()=>{this.publish(o.SubredditDataRequested,this.onRecentSubredditReceived)}),0)}disconnectedCallback(){super.disconnectedCallback()}getRecentSubreddits(){if(!i.isAvailable())return[];const e=i.getItem(d.RecentSubreddits);if(!e)return[];try{return JSON.parse(e).slice(0,5)}catch(e){return[]}}toggleExpanded(){this.expanded=!this.expanded}renderSubreddit(e){const t=e.communityIcon||e.iconImage,n=t?l`<faceplate-img \n class="rounded-full" \n loading="lazy" \n src="${t}" \n width="32" \n height="32" \n></faceplate-img>`:l`<icon-community class="text-32 w-xl h-xl"></icon-community>`;return l`<a \n class="flex items-center text-tone-1 no-underline text-16 my-sm" \n href="${e.url}" \n @click="${this.onSubredditClick}" \n>\n ${n}\n <div \n class="ml-sm m:block overflow-hidden text-ellipsis whitespace-nowrap ${this.expanded?"":"hidden"}" \n>\n ${e.displayNamePrefixed}\n </div>\n </a>`}render(){const e=this.getRecentSubreddits();return e.length?l`<details open>\n <summary class="list-none">\n <div class="flex items-center justify-between m:flex ${this.expanded?"":"hidden"}">\n <strong class="text-tone-1 whitespace-nowrap" \n>Recent Communities</strong>\n\n <icon-caret-down \n class="text-[20px] items-center justify-center m:flex ${this.expanded?"":"hidden"}" \n></icon-caret-down>\n </div>\n </summary>\n ${m(e,(e=>e.name),(e=>this.renderSubreddit(e)))}\n </details>\n <slot></slot>`:u}};e([t({type:Boolean})],f.prototype,"expanded",void 0),f=e([n("reddit-recent-communities")],f);
